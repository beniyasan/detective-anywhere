# MVP実装プラン - AIミステリー散歩

## 概要
ハッカソン向けの最小実用版（MVP）を2週間で実装するためのステップバイステッププラン。

## 目標
- **5分〜10分で遊べる**ミステリーゲーム体験
- **東京タワー周辺**や**山下公園**など分かりやすいPOIでのデモ
- **正解/不正解パターン**両方の体験提供

## Phase 1: バックエンドMVP実装 (Week 1: Day 1-3)

### 1.1 基本APIの実装 ✅
- [x] FastAPI セットアップ
- [x] データモデル定義
- [x] Gemini AI 連携
- [x] Google Maps API 連携
- [x] 基本的なAPIエンドポイント

### 1.2 コア機能の実装
- [ ] **シナリオ生成**
  - Gemini APIプロンプト最適化
  - 3-4名容疑者のシンプルなシナリオ
  - 日本の観光地に適したテンプレート作成
  
- [ ] **証拠システム**
  - POI位置への証拠配置ロジック
  - GPS距離計算・発見判定
  - 証拠の重要度分類（critical/important/misleading）
  
- [ ] **推理判定システム**
  - 犯人名の正誤判定
  - キャラクター反応生成
  - スコア計算システム

### 1.3 テストデータ作成
- [ ] **東京タワー周辺データ**
  - 半径1km以内のPOI収集
  - 5個の証拠配置ポイント選定
  - テストシナリオ3パターン作成

- [ ] **山下公園周辺データ**  
  - 横浜中華街・赤レンガ倉庫含む
  - 観光地向けシナリオテンプレート

## Phase 2: モバイルアプリMVP実装 (Week 1: Day 4-7)

### 2.1 Flutter プロジェクトセットアップ
- [ ] **基本構成**
  - Flutter 3.x プロジェクト初期化
  - 状態管理（Provider/Riverpod）
  - HTTP通信（dio package）
  - GPS機能（geolocator package）

### 2.2 画面設計・実装
- [ ] **ホーム画面**
  - 位置情報許可リクエスト
  - 「探偵事務所オープン」ボタン
  - 現在地表示

- [ ] **ゲーム開始画面**
  - 難易度選択（Easy固定でMVP）
  - 周辺POI表示・確認
  - シナリオ生成ローディング

- [ ] **シナリオ表示画面**
  - 事件タイトル・導入文
  - 容疑者一覧（写真なし、テキストのみ）
  - 証拠マップ（位置のみ表示）

- [ ] **探索画面**
  - リアルタイムマップ
  - 証拠地点マーカー
  - 現在地からの距離表示
  - 発見可能範囲の視覚化

- [ ] **証拠発見画面**
  - 証拠詳細表示
  - 発見時のドラマチック演出
  - 次のヒント表示

- [ ] **推理画面**
  - 容疑者選択リスト
  - 発見済み証拠の確認
  - 推理提出ボタン

- [ ] **結果画面**  
  - 正誤判定結果
  - キャラクター反応表示
  - スコア・統計情報
  - 「もう一度プレイ」ボタン

### 2.3 GPS・位置情報機能
- [ ] **位置取得機能**
  - 高精度GPS取得
  - バックグラウンド位置監視
  - 電池使用量最適化

- [ ] **距離計算・判定**
  - 証拠地点との距離リアルタイム計算
  - 50m以内の発見判定
  - 到達時の自動通知

## Phase 3: 統合・テスト (Week 2: Day 1-3)

### 3.1 バックエンド・フロントエンド統合
- [ ] **API接続テスト**
  - 全APIエンドポイントの動作確認
  - エラーハンドリング実装
  - オフライン対応（基本的なエラー表示）

- [ ] **実地テスト**
  - 東京タワー周辺での実際のGPS測定
  - 山下公園周辺での動作確認
  - 証拠発見の精度チェック

### 3.2 ユーザビリティ改善
- [ ] **UI/UX調整**
  - 操作の直感性向上
  - ローディング時間の短縮
  - エラーメッセージの改善

- [ ] **パフォーマンス最適化**
  - API レスポンス時間短縮
  - アプリ起動時間最適化
  - メモリ使用量削減

## Phase 4: デプロイ・デモ準備 (Week 2: Day 4-7)

### 4.1 本番環境デプロイ
- [ ] **Google Cloud デプロイ**
  - Cloud Run へのバックエンドデプロイ
  - Firestore データベース本番設定
  - DNS・SSL証明書設定

- [ ] **モバイルアプリ配布**
  - APKビルド（Android）
  - TestFlight配布（iOS）
  - QRコード配布システム

### 4.2 デモ環境構築
- [ ] **デモ用データ整備**
  - 安定動作するテストシナリオ
  - 複数難易度の体験コース
  - 時間短縮用のデバッグモード

- [ ] **プレゼン資料作成**
  - デモ動画撮影
  - システムアーキテクチャ図
  - 技術スタック説明

### 4.3 最終調整
- [ ] **バグ修正**
  - 致命的なエラーの解消
  - 動作安定性向上

- [ ] **ドキュメント整備**
  - README更新
  - API仕様書完成
  - デプロイ手順書作成

## 技術的制約・対応

### GPS精度問題
- **問題**: 屋内や高層ビル周辺でのGPS精度低下
- **対応**: 発見範囲を50m→100mに拡大、手動発見ボタン追加

### AI生成時間
- **問題**: Gemini APIの応答時間（10-30秒）
- **対応**: ローディング画面の改善、事前生成シナリオのキャッシュ

### 電池消耗
- **問題**: GPS常時監視による電池消耗
- **対応**: 位置更新頻度の最適化、スリープモード実装

## Success Metrics (成功指標)

### ユーザビリティ
- [ ] **完了率**: 80%以上のユーザーが推理まで完了
- [ ] **プレイ時間**: 平均5-10分以内での完了
- [ ] **エラー率**: GPS取得失敗率5%以下

### 技術性能
- [ ] **API応答**: 平均3秒以内
- [ ] **シナリオ生成**: 30秒以内
- [ ] **位置精度**: 50m以内での証拠発見成功率90%以上

### ビジネス価値
- [ ] **再プレイ率**: 30%以上のユーザーが複数回プレイ
- [ ] **推薦度**: デモ体験者の70%以上が他者に推薦意向

## リスク対応

### 高リスク
1. **Gemini API制限**
   - 対応: 事前生成シナリオの準備、OpenAI GPT-4バックアップ
   
2. **GPS精度問題**
   - 対応: 手動発見オプション、範囲拡大設定

3. **Google Maps API費用**
   - 対応: キャッシュ機能、POI数制限

### 中リスク
1. **Cloud Run コールドスタート**
   - 対応: Cloud Scheduler での定期実行
   
2. **Firestore 読み書き制限**
   - 対応: データ構造最適化、キャッシュ戦略

## 完成後の拡張計画

### Phase 2 拡張機能
- 難易度選択（Normal/Hard）
- ユーザー履歴・ランキング
- ソーシャル共有機能

### Phase 3 高度化
- 音声・TTS対応
- AR証拠発見モード
- マルチプレイヤー対応
- カスタムシナリオ作成

このMVP実装プランに従い、2週間でハッカソンに向けた実用的なプロトタイプを完成させます。